---
title: "Exploring the BRFSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
```

### Load data

Make sure your data and R Markdown files are in the same directory. When loaded
your data file will be called `brfss2013`. Delete this note when before you submit 
your work. 

```{r load-data}
load("brfss2013.RData")
```



* * *

## Part 1: Data


* * *

## Part 2: Research questions

**Research quesion 1:**
My first question is: Is there a relationship between income and number of days of poor (specified as 'not good') health? 

Within the data, there are two categorical variables associated with health; number of days of poor (not good) physical health and number of days of poor (not good) mental health. 

It will be interesting to understand if mental or physical health illness, or both, are more prevalent within certain income types, as well as what the average looks like for survey participants.
**Research quesion 2:**

**Research quesion 3:**


* * *

## Part 3: Exploratory data analysis

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button (green button with orange arrow) above. Make sure that your code is visible
in the project you submit. Delete this note when before you submit your work.

**Research quesion 1:**
In the first instance, I want to exclude data that is NA, as this is not relevant to my question, for example, we only want to compare mental and physical health where we know the income amount.
```{r}
brfss2013 %>% filter(!is.na(income2),!is.na(physhlth),!is.na(menthlth)) %>%
 group_by(income2,physhlth,menthlth) %>% summarise(count=n())
```

Next, I am interested to understand what the mean, median and standard deviation looks like for days of not good mental and physical health. This will help me understand if there are any initial skews within the data.

```{r}
brfss2013 %>% filter(!is.na(menthlth)) %>% summarise(mean_mental = mean(menthlth), median_mental = median(menthlth), sd_mental=sd(menthlth), n=n())
```

We can see that there is a big difference between the mean and the median. This suggests a right skew, as the mean is greater than the median. We can confirm this by building a histogram:

```{r}
ggplot(data=subset(brfss2013, !is.na(menthlth)), aes(x=menthlth)) + geom_histogram(binwidth=0.5) + xlim(0, 50)
```

This right skew is confirmed by the histogram. Understanding the skew of the data helps us to see that this is not a normal distribution. We can then see if there are any differences with the physical health variable.

```{r}
brfss2013 %>% filter(!is.na(physhlth)) %>% summarise(mean_physical = mean(physhlth), median_physical = median(physhlth), sd_physical=sd(physhlth), n=n())
```

Again, we can see that the mean is much greater than the median. Creating another histogram, we can then view the distribution of this variable.

```{r}
ggplot(data=subset(brfss2013, !is.na(physhlth)), aes(x=physhlth)) + geom_histogram(binwidth=0.5) + xlim(0, 50)
```

We can now confirm there is a definite right skew for the amount of not good physical and mental health days. We therefore need to use a robust statistic for understanding if the number of not good mental and physical health days differs per income type.

To understand how we'll calculate this, we'll then look at the different groupings of income type.

```{r}
brfss2013 %>% filter(!is.na(income2)) %>%
+  group_by(income2) %>% summarise(count=n())
```

First, let's take a look at the median, mean and standard deviation for the extreme ends of this data: income of less than $10,000 and $75,000 or more, for each variable.

```{r}
brfss2013 %>% filter(!is.na(physhlth),!is.na(menthlth),income2 =="Less than $10,000") %>% summarise(mean_physical_ten = mean(physhlth), median_physical_ten = median(physhlth), sd_physical_ten=sd(physhlth), mean_mental_ten=mean(menthlth), median_mental_ten=median(menthlth), sf_mental_ten=sd(menthlth))
```

Breaking this down, we can see that there is a median of 2 not good physical health days for the income type below $10,000. There is a median of 0 for not good mental health days.

Now, let's take a look at the other end of the spectrum; earners over $75,000.

```{r}
brfss2013 %>% filter(!is.na(physhlth),!is.na(menthlth),income2 =="$75,000 or more") %>% summarise(mean_physical_seven = mean(physhlth), median_physical_seven = median(physhlth), + sd_physical_seven=sd(physhlth), mean_mental_seven=mean(menthlth), median_mental_seven=median(menthlth), sf_mental_seven=sd(menthlth))
```

Here we can see medians of 0 for both not good mental and physical health days. While this analysis has been helpful, it is focused on the extreme ends. Following further research, we can see that in the United States, the median household income for 2013 (when this survey took place) equals $51,939 (source: https://en.wikipedia.org/wiki/Household_income_in_the_United_States). Let's therefore create a new variable which creates a number only version of the income bands and then another which separates survey participants into below and equals/above median income.

```{r}
income_raw <-gsub("Less than", "", brfss2013$income2)
income_raw <-gsub("or more", "", brfss2013$income2)
income_raw <-gsub("$", "", brfss2013$income2)
```

```{r}
brfss2013 <- brfss2013 %>% mutate(income_median= ifelse(income_raw >=51939, "Below", "Above"))
```

We can then create the same variables below and above the US median income.

```{r}
brfss2013 %>% filter(!is.na(physhlth),!is.na(menthlth),income_median =="Above") %>% summarise(mean_physical_above = mean(physhlth), median_physical_above = median(physhlth), sd_physical_above=sd(physhlth), mean_mental_above=mean(menthlth), median_mental_above=median(menthlth), sf_mental_above=sd(menthlth))
```

And then below:

```{r}
brfss2013 %>% filter(!is.na(physhlth),!is.na(menthlth),income_median =="Below") %>% summarise(mean_physical_below = mean(physhlth), median_physical_below = median(physhlth), sd_physical_below=sd(physhlth), mean_mental_below=mean(menthlth), median_mental_below=median(menthlth), sf_mental_below=sd(menthlth))
```

We can see that the medians remain the same, but there is a large discrepancy in the averages for those above/below the median income. While the mean is not a robust statisic in this instance, creating a further histogram showing the distribution of not good mental and physical health days depending on whether the income is above or below the median could be valuable. I believe this is valuable as the data has already indicated a difference between income and mental and physical health, so visualising this will help us understand it further.


**Research quesion 2:**

```{r}

```



**Research quesion 3:**

```{r}

```

